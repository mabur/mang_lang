risk_levels@{
    map = (
        "bbbbbbbbbbbb"
        "b2199943210b"
        "b3987894921b"
        "b9856789892b"
        "b8767896789b"
        "b9899965678b"
        "bbbbbbbbbbbb"
    )
    parse_height = in character out
        is character
            \b then 10
            else parse_digit!character
    height = count!map
    width = count!top@map
    num_low_points = 0
    risk_levels = 0
    y = 0
    while less?(y sub!(height 2))
        row_above = first!map
        row_middle = second!map
        row_below = third!map
        x = 0
        while less?(x sub!(width 2))
            point = parse_height!second!row_middle
            neighbours = (
                parse_height!second!row_above
                parse_height!first!row_middle
                parse_height!third!row_middle
                parse_height!second!row_below
            )
            is_low_point = less?(point min!neighbours)
            num_low_points =
                if is_low_point then
                    inc!num_low_points
                else
                    num_low_points
            risk_levels =
                if is_low_point then
                    add!(risk_levels point 1)
                else
                    risk_levels
            row_above = rest@row_above
            row_middle = rest@row_middle
            row_below = rest@row_below
            x = inc!x
        end
        map = rest@map
        y = inc!y
    end
}
